<!-- PATH: /Tour/Tour_Receipt.html :: FULL FILE -->

<style>
  /* ===== 문의 & 예약 상담 박스 전용 스타일 ===== */

  .booking-card{
    /* sticky는 aside에서 처리, 카드는 그냥 박스 */
    background:var(--panel);
    border-radius:var(--radius-lg);
    box-shadow:var(--shadow-soft);
    padding:18px 18px 20px;
    max-width:100%;
    box-sizing:border-box;
    overflow:hidden; /* 내부 요소가 넘치면 잘라냄 */
  }

  .booking-card h2{
    margin:0 0 4px;
    font-size:16px;
  }

  .side-note{
    margin:0 0 12px;
    font-size:12px;
    color:var(--muted);
  }

  .booking-form{
    display:flex;
    flex-direction:column;
    gap:10px;
  }

  .field{
    display:flex;
    flex-direction:column;
    gap:4px;
  }

  .field-label{
    font-size:12px;
    font-weight:500;
  }

  .field input,
  .field textarea{
    border-radius:10px;
    border:1px solid var(--line);
    padding:8px 10px;
    outline:none;
    transition:border-color .15s ease, box-shadow .15s ease;
    resize:vertical;
  }

  .field input:focus,
  .field textarea:focus{
    border-color:var(--brand);
    box-shadow:0 0 0 1px var(--brand-soft);
  }

  .side-help{
    margin:8px 0 0;
    font-size:11px;
    color:var(--muted);
  }

  /* ===== 연락처 전용 레이아웃 ===== */
  .phone-row{
    display:grid;
    grid-template-columns:auto minmax(0,1fr) auto minmax(0,1fr);
    column-gap:4px;
    align-items:center;
    width:100%;
  }

  .phone-prefix,
  .phone-dash{
    font-size:13px;
    color:var(--ink);
    white-space:nowrap;
  }

  .phone-row input{
    width:100%;
    min-width:0;  /* 좁은 화면에서도 안 튀어나가게 */
  }
</style>

<!-- 응답 받아줄 숨은 iframe: 페이지 이동 막기용 -->
<iframe name="navitour-detail-target" style="display:none;"></iframe>

<section class="booking-card">
  <h2>문의 &amp; 예약 상담</h2>
  <p class="side-note">간단한 정보만 남겨주시면, 24시간 이내에 담당자가 연락드립니다.</p>

  <!-- contact.html에서 쓰는 /exec와 반드시 같은 URL -->
  <form
    class="booking-form"
    id="prod-booking-form"
    action="https://script.google.com/macros/s/AKfycbxQai3l8uCAlzDggHGrPdm_E9iY2zg7Uv9vTJNt1iiHvSSg9b_MW7UoDzZ4T2EJ0CnI/exec"
    method="post"
    target="navitour-detail-target"
    onsubmit="
      var f = this;
      var d = document;

      // 연락처(010-xxxx-xxxx) 조합 & 검증
      var midInput       = f.elements['phone_mid'];
      var lastInput      = f.elements['phone_last'];
      var contactHidden  = f.elements['contact'];

      var mid  = midInput  ? midInput.value.replace(/\D/g,'')  : '';
      var last = lastInput ? lastInput.value.replace(/\D/g,'') : '';

      if (!mid || !last || mid.length !== 4 || last.length !== 4) {
        alert('연락처를 010-0000-0000 형식으로 입력해 주세요.');
        if (midInput && mid.length !== 4)      { midInput.focus(); }
        else if (lastInput && last.length !== 4){ lastInput.focus(); }
        return false;
      }

      if (contactHidden) {
        contactHidden.value = '010-' + mid + '-' + last;
      }

      // 페이지 메타
      if (f.elements['page_url'])   f.elements['page_url'].value   = d.location.href;
      if (f.elements['page_title']) f.elements['page_title'].value = d.title || '';

      // body에 data-product-sheet / data-product-slug가 박혀 있으면 상품 메타 넣어줌
      if (d.body && d.body.dataset) {
        if (f.elements['product_sheet']) f.elements['product_sheet'].value = d.body.dataset.productSheet || '';
        if (f.elements['product_slug'])  f.elements['product_slug'].value  = d.body.dataset.productSlug  || '';
      }

      alert('문의가 전송되었습니다.\n담당자가 확인 후 연락드리겠습니다.');
      return true;
    "
  >
    <!-- 숨은 필드: 공통 메타 -->
    <input type="hidden" name="source" value="prod_sidebar">
    <input type="hidden" name="page_url" value="">
    <input type="hidden" name="page_title" value="">

    <!-- 숨은 필드: 상품 메타 (시트/슬러그/이름/지역/일정) -->
    <input type="hidden" name="product_sheet" value="">
    <input type="hidden" name="product_slug" value="">
    <input type="hidden" name="product_title" value="">
    <input type="hidden" name="product_region" value="">
    <input type="hidden" name="product_nights" value="">
    <input type="hidden" name="product_days" value="">

    <!-- 연락처 실제로 시트에 넘어가는 값 -->
    <input type="hidden" name="contact" value="">

    <label class="field">
      <span class="field-label">단체명</span>
      <input type="text" name="group_name" placeholder="학교 / 교회 / 기관 이름">
    </label>

    <label class="field">
      <span class="field-label">예상 인원</span>
      <input type="text" name="headcount" placeholder="예: 학생 30명 + 인솔 4명">
    </label>

    <label class="field">
      <span class="field-label">희망 출발일</span>
      <input type="date" name="depart_date">
    </label>

    <label class="field">
      <span class="field-label">연락처</span>
      <div class="phone-row">
        <span class="phone-prefix">010-</span>
        <input
          type="tel"
          name="phone_mid"
          placeholder="0000"
          maxlength="4"
          oninput="this.value=this.value.replace(/\D/g,'').slice(0,4);"
          required
        >
        <span class="phone-dash">-</span>
        <input
          type="tel"
          name="phone_last"
          placeholder="0000"
          maxlength="4"
          oninput="this.value=this.value.replace(/\D/g,'').slice(0,4);"
          required
        >
      </div>
    </label>

    <label class="field">
      <span class="field-label">추가 요청사항</span>
      <textarea rows="4" name="memo" placeholder="원하는 포인트, 방문하고 싶은 장소, 일정 길이 등을 적어 주세요."></textarea>
    </label>

    <button type="submit" class="btn primary full">상세 견적 요청하기</button>
    <p class="side-help">온라인 문의 후, 유선 상담으로 세부 일정을 함께 조율합니다.</p>
  </form>
</section>
